<!DOCTYPE html>

<html>
    <head>
        <style>
            h1 {
                width: 100px;
            }
        </style>
    </head>

    <body>
        <input
            type="range"
            id="MasterVolume"
            name="volume"
            min="16"
            max="80"
            oninput="WebSocketTest(this)"
            style="width: 100%; height: 200px"
        />
        <script type="text/javascript">
            function WebSocketTest(e) {
                if ("WebSocket" in window) {
                    console.log("WebSocket is supported by your Browser!");
                    let curent_domain = "ws://6e55-138-199-21-203.ngrok.io/ws";
                    let localhost_domain = "ws://{{IP}}:{{PORT}}/ws";

                    // Let us open a web socket
                    var ws = new WebSocket(localhost_domain);

                    ws.onopen = function () {
                        // Web Socket is connected, send data using send()
                        ws.send(e.value);
                        console.log(`Message ${e.value} is sent...`);
                    };

                    ws.onmessage = function (evt) {
                        var received_msg = evt.data;
                        let h1_volume = document.getElementById("volume");
                        h1_volume.textContent = `Volume: ${received_msg}`;
                        // console.log(`Message is received...: ${received_msg}`);
                        // let mv = document.getElementById("MasterVolume");
                        // mv.value = parseInt(received_msg);
                    };

                    ws.onclose = function () {
                        // websocket is closed.
                        console.log("Connection is closed...");
                    };
                } else {
                    // The browser doesn't support WebSocket
                    console.log("WebSocket NOT supported by your Browser!");
                }
            }
        </script>

        <h1 id="volume">Volume: 40</h1>
    </body>
</html>
